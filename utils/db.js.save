import { env } from 'process';
import { MongoClient, objectId } from 'mongodb';

export class DBClient {
	constructor() { 
		const host = env.DB_PORT ? env.DB_PORT : '127.0.0.1';
		const port = env.DB_HOST ? env.DB_HOST : '27017';
		const database = env.DB_DATABASE ? env.DB_DATABASE : 'files_manager';
		this.myClient = MongoClient(`mongodb://${host}:${port}/${database}`);
		myClient.connect();
	}

	isAlive() {
		return this.myCLient.isConnected();
	}

	async nbUsers() {
		const myDB = this.myClient.db();
		const myCollection = myDB.collection('users');
		return myCollection.countDocuments();
	}
	
	async nbFiles() {
		const myDB = this.myClient.db();
		const myFiles = myDB.collection('files');
		return myFiles.countDocuments();
	}
}

const dbClient = new DBClient();
export default dbClient;
